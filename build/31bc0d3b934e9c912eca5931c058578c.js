require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var s=e[n]=new t.Module(n);r[n][0].call(s.exports,i,s,s.exports)}return e[n].exports}function o(r){this.id=r,this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.isParcelRequire=!0,t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({9:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GameState=exports.O=exports.X=void 0;var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),t=require("./main");function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=exports.X="X",a=exports.O="O",i=0,o=exports.GameState=function(){function n(e,t){r(this,n),this.board=_.clone(e)||_.fill(Array(9),null),this.playerTurn=t,this.minimax=-100,this.choosenState=null,this.winner=!1}return e(n,[{key:"getAvailablePos",value:function(){var e=[];return this.board.forEach(function(t,r){t||e.push(r)}),e}},{key:"checkFinish",value:function(){for(var e=this.board,t=0;t<9;t+=3)if(e[t]&&e[t]===e[t+1]&&e[t]===e[t+2])return e[t];for(var r=0;r<3;r++)if(e[r]&&e[r]===e[r+3]&&e[r]===e[r+6])return e[r];return e[0]&&e[0]===e[4]&&e[0]===e[8]?e[0]:e[2]&&e[2]===e[4]&&e[2]===e[6]?e[2]:9===_.compact(e).length&&"draw"}},{key:"generateNextStates",value:function(){var e=this,t=[];return this.getAvailablePos().forEach(function(r){var a=_.clone(e.board);a[r]=e.playerTurn;var i=u(e.playerTurn);t.push(new n(a,i))}),t}},{key:"getMinimax",value:function(){var e=(0,t.getAiToken)(),r=this.checkFinish();if(r)return"draw"===r?0:r===e?10:-10;var n=this.generateNextStates(),a=[];n.forEach(function(e){a.push(e.getMinimax())});var i=void 0;i=this.playerTurn===e?Math.max.apply(Math,a):Math.min.apply(Math,a);for(var o=[],u=0;u<a.length;u++)a[u]===i&&o.push(u);var s=n[_.sample(o)];return this.choosenState=s,s.getMinimax()}},{key:"nextMove",value:function(){this.board=_.clone(this.choosenState.board)}}]),n}();function u(e){return e===n?a:n}
},{"./main":6}],10:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.px2Index=t,exports.drawGrid=r,exports.initCanvas=l,exports.draw=a;var e=0,o=0;function t(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GRID_SIZE,i=e,l=o;return{col:Math.floor((t-i)/n),row:Math.floor((r-l)/n)}}function r(e,o,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GRID_SIZE,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;e.strokeStyle=n,e.lineWidth=3,e.beginPath(),e.moveTo(i-.5,l),e.lineTo(i-.5,t*r+l);for(var a=0;a<o+1;a++)e.moveTo(a*r-.5+i,l),e.lineTo(a*r-.5+i,t*r+l);e.stroke(),e.moveTo(i,l-.5),e.lineTo(o*r+i,l-.5);for(var d=0;d<t+1;d++)e.moveTo(i,d*r-.5+l),e.lineTo(o*r+i,d*r-.5+l);e.stroke()}var n=exports.canvas=document.getElementById("board"),i=exports.ctx=n.getContext("2d");function l(){n.width=450,n.height=450}function a(e){i.clearRect(0,0,n.width,n.height),r(i,3,3,150),i.font="40px Arial",e.forEach(function(e,o){e&&(i.fillStyle="X"===e?"red":"green",i.fillText(e,150*(o%3+.4),150*(Math.floor(o/3)+.6)))})}
},{}],6:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAiToken=m;var e=require("./ai"),n=require("./draw"),t=e.O,r=new e.GameState(i,t),i=_.fill(Array(9),null);function o(e){var t=n.canvas.getBoundingClientRect(),r=e.clientX-t.left,i=e.clientY-t.top,o=(0,n.px2Index)(r,i,150),a=o.col;c(o.row,a)}function a(e,n){return 3*e+n}function c(i,o){var c=a(i,o);if(!r.board[c]&&!r.winner){var l=_.clone(r.board);l[c]=t===e.X?e.O:e.X,r.board=_.clone(l),(0,n.draw)(r.board),u(),setTimeout(d,1e3)}}function d(){r.winner||(r.getMinimax(),r.nextMove(),(0,n.draw)(r.board),u())}function u(){var e=r.checkFinish();e&&(console.log("游戏结束",e),document.getElementById("winner").innerHTML="draw"===e?"Draw":"Winner is: "+e,r.winner=e)}function l(n){var o=n.target.dataset.token;t=o===e.X?e.O:e.X,o===e.O&&(r=new e.GameState(i,t),s(o),setTimeout(d,0))}function s(e){document.getElementById("show-choice").innerHTML="Your choice: "+e}function m(){return t}function w(){s((t=e.O)===e.X?e.O:e.X),r=new e.GameState(i,t),(0,n.draw)(r.board),document.getElementById("winner").innerHTML=""}function v(){(0,n.initCanvas)(),r=new e.GameState(i,t),(0,n.draw)(r.board);var o=document.getElementById("btn-choose-o"),a=document.getElementById("btn-choose-x");o.addEventListener("click",l),a.addEventListener("click",l),document.getElementById("restart-game").addEventListener("click",w)}n.canvas.addEventListener("click",o,!1),v();
},{"./ai":9,"./draw":10}]},{},[6])