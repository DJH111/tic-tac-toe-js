require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var s=e[n]=new t.Module(n);r[n][0].call(s.exports,i,s,s.exports)}return e[n].exports}function o(r){this.id=r,this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.isParcelRequire=!0,t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({4:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=exports.X="X",r=exports.O="O",a=n,i=0,o=exports.GameState=function(){function n(e,r){t(this,n),this.board=_.clone(e)||_.fill(Array(9),null),this.playerTurn=r,this.minimax=-100,this.availablePos=[],this.possiableChildState=[],this.choosenState=null,this.winner=!1}return e(n,[{key:"getAvailablePos",value:function(){var e=[];return this.board.forEach(function(t,n){t||e.push(n)}),e}},{key:"checkFinish",value:function(){for(var e=this.board,t=0;t<9;t+=3)if(e[t]&&e[t]===e[t+1]&&e[t]===e[t+2])return e[t];for(var n=0;n<3;n++)if(e[n]&&e[n]===e[n+3]&&e[n]===e[n+6])return e[n];return e[0]&&e[0]===e[4]&&e[0]===e[8]?e[0]:e[2]&&e[2]===e[4]&&e[2]===e[6]?e[2]:0===this.getAvailablePos().length&&"draw"}},{key:"generateNextStates",value:function(){var e=this,t=[];return this.getAvailablePos().forEach(function(r){var a=_.clone(e.board);a[r]=e.playerTurn,t.push(new n(a,u(e.playerTurn)))}),t}},{key:"getMinimax",value:function(){var e=this.checkFinish();if(e)return"draw"===e?0:e===a?10:-10;var t=this.generateNextStates(),n=[];t.forEach(function(e){n.push(e.getMinimax())});var r=void 0;r=this.playerTurn===a?Math.max.apply(Math,n):Math.min.apply(Math,n);for(var i=[],o=0;o<n.length;o++)n[o]===r&&i.push(o);var u=t[_.sample(i)];return this.choosenState=u,u.getMinimax()}},{key:"nextMove",value:function(){this.board=_.clone(this.choosenState.board)}}]),n}();function u(e){return e===n?r:n}
},{}],5:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.px2Index=t,exports.drawGrid=r,exports.initCanvas=l,exports.draw=a;var e=0,o=0;function t(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GRID_SIZE,i=e,l=o;return{col:Math.floor((t-i)/n),row:Math.floor((r-l)/n)}}function r(e,o,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:GRID_SIZE,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;e.strokeStyle=n,e.lineWidth=3,e.beginPath(),e.moveTo(i-.5,l),e.lineTo(i-.5,t*r+l);for(var a=0;a<o+1;a++)e.moveTo(a*r-.5+i,l),e.lineTo(a*r-.5+i,t*r+l);e.stroke(),e.moveTo(i,l-.5),e.lineTo(o*r+i,l-.5);for(var d=0;d<t+1;d++)e.moveTo(i,d*r-.5+l),e.lineTo(o*r+i,d*r-.5+l);e.stroke()}var n=exports.canvas=document.getElementById("board"),i=exports.ctx=n.getContext("2d");function l(){n.width=450,n.height=450}function a(e){i.clearRect(0,0,n.width,n.height),r(i,3,3,150),i.font="40px Arial",e.forEach(function(e,o){e&&(i.fillStyle="X"===e?"red":"green",i.fillText(e,150*(o%3+.4),150*(Math.floor(o/3)+.6)))})}
},{}],3:[function(require,module,exports) {
"use strict";var n=require("./ai"),e=require("./draw"),r=_.fill(Array(9),null),i=new n.GameState(r,n.X);function a(n){var r=e.canvas.getBoundingClientRect(),i=n.clientX-r.left,a=n.clientY-r.top,t=(0,e.px2Index)(i,a,150),c=t.col;o(t.row,c)}function t(n,e){return 3*n+e}function o(r,a){var o=t(r,a);if(!i.board[o]&&!i.winner){var l=_.clone(i.board);l[o]=n.O,i.board=_.clone(l),(0,e.draw)(i.board),d(),setTimeout(c,1e3)}}function c(){i.winner||(i.getMinimax(),i.nextMove(),(0,e.draw)(i.board),d())}function d(){var n=i.checkFinish();n&&(console.log("游戏结束",n),document.getElementById("winner").innerHTML="draw"===n?"Draw":"Winner is: "+n,i.winner=n)}e.canvas.addEventListener("click",a,!1),(0,e.initCanvas)(),(0,e.draw)(i.board),c();
},{"./ai":4,"./draw":5}]},{},[3])